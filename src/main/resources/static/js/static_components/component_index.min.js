$(document).ready(function(){getRecommendationGameCardHtml().then(function(a){index_init(a)})});function index_init(a){showGameByPromotion(a);showGameByScore(a);showFreeGame(a);showNewGame(a);showPreGame(a)}function getRecommendationGameCardHtml(){return new Promise(function(a){$.get(dynamic_components.component_game_recommendation_card.curl,function(b){a(b)})})}function showGameByPromotion(a){let data={pageCount:index_pageCount,pageIndex:index_pageIndex,sort:"discount"};$.post(requestmap.store_search,data,function(b){if(b.status===1){let finalHtml="";$.each(b.resultMap.searchList,function(c,d){let html=$(a);html.find(".index-game-card-cover-container img").attr("src",d.chref);html.find(".index-game-card-info-container > p").text(d.gname);let save=((1-d.discount)*100).toFixed();html.find(".index-game-card-info-price-container > span").text("-"+save+"%");html.find(".index-game-card-info-price-container > div > span:first-of-type").text("￥"+d.gprice);html.find(".index-game-card-info-price-container > div > span:last-of-type").text("￥"+d.gprice*d.discount);finalHtml+=html.html()});$("#recommendation-promotion").html(finalHtml)}else{ajaxNoContent("#recommendation-promotion")}}).fail(function(){ajaxFailed("#recommendation-promotion")})}function showGameByScore(a){let data={pageCount:index_pageCount,pageIndex:index_pageIndex,sort:"score"};$.post(requestmap.store_search,data,function(b){if(b.status===1){let finalHtml="";$.each(b.resultMap.searchList,function(c,d){let html=$(a);html.find(".index-game-card-cover-container img").attr("src",d.chref);html.find(".index-game-card-info-container > p").text(d.gname);if(d.gprice===0){html.find(".index-game-card-discount-label").text("免费");html.find(".index-game-card-info-price-container > span").hide();html.find(".index-game-card-info-price-container > div > span:first-of-type").hide();html.find(".index-game-card-info-price-container > div > span:last-of-type").css("margin-top","15px");html.find(".index-game-card-info-price-container > div > span:last-of-type").text("免费")}else{if(d.discount===1){html.find(".index-game-card-discount-label").hide();html.find(".index-game-card-info-price-container > span").hide();html.find(".index-game-card-info-price-container > div > span:first-of-type").hide();html.find(".index-game-card-info-price-container > div > span:last-of-type").css("margin-top","15px");html.find(".index-game-card-info-price-container > div > span:last-of-type").text("￥"+d.gprice)}else{let save=((1-d.discount)*100).toFixed();html.find(".index-game-card-info-price-container > span").text("-"+save+"%");html.find(".index-game-card-info-price-container > div > span:first-of-type").text("￥"+d.gprice);html.find(".index-game-card-info-price-container > div > span:last-of-type").text("￥"+d.gprice*d.discount)}}finalHtml+=html.html()});$("#recommendation-score").html(finalHtml)}else{ajaxNoContent("#recommendation-score")}}).fail(function(){ajaxFailed("#recommendation-score")})}function showFreeGame(a){let data={pageCount:index_pageCount,pageIndex:index_pageIndex,minPrice:0,maxPrice:0};$.post(requestmap.store_search,data,function(b){if(b.status===1){let finalHtml="";$.each(b.resultMap.searchList,function(c,d){let html=$(a);html.find(".index-game-card-cover-container img").attr("src",d.chref);html.find(".index-game-card-info-container > p").text(d.gname);html.find(".index-game-card-discount-label").text("免费");html.find(".index-game-card-info-price-container > span").hide();html.find(".index-game-card-info-price-container > div > span:first-of-type").hide();html.find(".index-game-card-info-price-container > div > span:last-of-type").css("margin-top","15px");html.find(".index-game-card-info-price-container > div > span:last-of-type").text("免费");finalHtml+=html.html()});$("#recommendation-free").html(finalHtml)}else{ajaxNoContent("#recommendation-free")}}).fail(function(){ajaxFailed("#recommendation-free")})}function showNewGame(a){let data={pageCount:index_pageCount,pageIndex:index_pageIndex,tag:JSON.stringify(["newsale"])};$.post(requestmap.store_search,data,function(b){if(b.status===1){let finalHtml="";$.each(b.resultMap.searchList,function(c,d){let html=$(a);html.find(".index-game-card-cover-container img").attr("src",d.chref);html.find(".index-game-card-info-container > p").text(d.gname);if(d.gprice===0){html.find(".index-game-card-discount-label").text("免费");html.find(".index-game-card-info-price-container > span").hide();html.find(".index-game-card-info-price-container > div > span:first-of-type").hide();html.find(".index-game-card-info-price-container > div > span:last-of-type").css("margin-top","15px");html.find(".index-game-card-info-price-container > div > span:last-of-type").text("免费")}else{if(d.discount===1){html.find(".index-game-card-discount-label").hide();html.find(".index-game-card-info-price-container > span").hide();html.find(".index-game-card-info-price-container > div > span:first-of-type").hide();html.find(".index-game-card-info-price-container > div > span:last-of-type").css("margin-top","15px");html.find(".index-game-card-info-price-container > div > span:last-of-type").text("￥"+d.gprice)}else{let save=((1-d.discount)*100).toFixed();html.find(".index-game-card-info-price-container > span").text("-"+save+"%");html.find(".index-game-card-info-price-container > div > span:first-of-type").text("￥"+d.gprice);html.find(".index-game-card-info-price-container > div > span:last-of-type").text("￥"+d.gprice*d.discount)}}finalHtml+=html.html()});$("#recommendation-new").html(finalHtml)}else{ajaxNoContent("#recommendation-new")}}).fail(function(){ajaxFailed("#recommendation-new")})}function showPreGame(a){let data={pageCount:index_pageCount,pageIndex:index_pageIndex,tag:JSON.stringify(["presale"])};$.post(requestmap.store_search,data,function(b){if(b.status===1){let finalHtml="";$.each(b.resultMap.searchList,function(c,d){let html=$(a);html.find(".index-game-card-cover-container img").attr("src",d.chref);html.find(".index-game-card-info-container > p").text(d.gname);html.find(".index-game-card-discount-label").text("即将上线");html.find(".index-game-card-info-price-container > span").hide();html.find(".index-game-card-info-price-container > div > span:first-of-type").hide();html.find(".index-game-card-info-price-container > div > span:last-of-type").css("margin-top","15px");html.find(".index-game-card-info-price-container > div > span:last-of-type").text(d.realeasedate.split(" ")[0]);finalHtml+=html.html()});$("#recommendation-pre").html(finalHtml)}else{ajaxNoContent("#recommendation-pre")}}).fail(function(){ajaxFailed("#recommendation-pre")})};